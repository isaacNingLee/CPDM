Wed Jan 10 19:13:37 2024       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 510.85.02    Driver Version: 510.85.02    CUDA Version: 11.6     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100 80G...  On   | 00000000:CA:00.0 Off |                    0 |
| N/A   33C    P0    44W / 300W |      0MiB / 81920MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
Dataset root = /fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI
Files already downloaded and verified
Files already downloaded and verified
Already extracted Mnist dataset in /fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI
Preparing dataset
Already cleaned up original val
Already divided into tasks
Task imgfolders already present.
PREPARED DATASET
Task 1: dset_sizes = {'train': 25000, 'val': 5000, 'test': 5000}, #classes = 50
Task 2: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
Task 3: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
Task 4: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
Task 5: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
Task 6: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
Task 7: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
Task 8: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
Task 9: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
Task 10: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
Task 11: dset_sizes = {'train': 2500, 'val': 500, 'test': 500}, #classes = 5
STARTING FROM EXISTING ALEXNET MODEL (name= alexnetCI_pretrained_imgnet ) to  /fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/models/alexnetCI_pretrained_imgnet.pth.tar
AlexNet(
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(11, 11), stride=(4, 4), padding=(2, 2))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
    (3): Conv2d(64, 192, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2))
    (4): ReLU(inplace=True)
    (5): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
    (6): Conv2d(192, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (7): ReLU(inplace=True)
    (8): Conv2d(384, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (9): ReLU(inplace=True)
    (10): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (11): ReLU(inplace=True)
    (12): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(6, 6))
  (classifier): Sequential(
    (0): Dropout(p=0.5, inplace=False)
    (1): Linear(in_features=9216, out_features=4096, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.5, inplace=False)
    (4): Linear(in_features=4096, out_features=4096, bias=True)
    (5): ReLU(inplace=True)
    (6): Linear(in_features=4096, out_features=1000, bias=True)
  )
)
None
RUNNING MODEL:  alexnetCI_pretrained_imgnet
Retaining default value ulhyper=3.0
INIT HYPERPARAMETERS: OrderedDict([('ulhyper', 3.0)])
Retaining default value classifier_type=self
INIT HYPERPARAMETERS: OrderedDict([('classifier_type', 'self')])
Experiment name:  dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self
Starting from model =  /fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/models/alexnetCI_pretrained_imgnet.pth.tar
Starting with ARGS={'seed': 0, 'model_name': 'alexnetCI_pretrained', 'method_name': 'CPDM', 'ds_name': 'cifar100CI', 'image_size': 64, 'gridsearch_name': 'demo', 'exp_name': 'dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self', 'starting_task_count': 1, 'max_task_count': 11, 'finetune_iterations': 1, 'saving_freq': 2, 'save_models_FT_heuristic': False, 'runmode': None, 'cleanup_exp': False, 'task_counter': 1, 'drop_margin': 0.5, 'decaying_factor': 0.5, 'max_attempts_per_task': 1, 'hyperparams': '', 'static_hyperparams': '', 'lr_grid': [0.05, 0.01, 0.005, 0.001, 0.0001, 1e-05], 'boot_lr_grid': [0.05, 0.01, 0.005, 0.001, 0.0001, 1e-05], 'num_epochs': 100, 'weight_decay': 0.0005, 'batch_size': 256, 'class_incremental': True, 'CI_task_count': 10, 'CI_order_rndseed': None, 'CPDM_generator_factor': 0.25, 'class_incremental_repetition': False, 'num_run': 10, 'test_max_task_count': 11, 'test_starting_task_count': 1, 'test_overwrite_mode': True, 'test_set': 'test', 'ddpm': False, 'diffusion_without_replay': False, 'embed_condition': 'default', 'label_hid_dim': 768, 'drop_labels_prob': 0.2, 'w': 3.0, 'ce_enhanced_weight': 0.0, 'ce_uncertainty_weight': 0.0, 'use_discriminator': False, 'unet_discriminator': False, 'discriminator_lr': 0.001, 'g_loss_weight': 0.0, 'n_critic': 1, 'random_label': False, 'wgan': False, 'wgan_gradient_penalty_weight': 0.0, 'wgan_n_critic': 1, 'wgan_set_weight': False, 'nearest_label': 'cosine', 'tau': 0.0001, 'image_condition': 'learn', 'learning_start': 'most', 'image_condition_learn_lr': 0.01, 'image_condition_learn_L2': 0.01, 'max_grad_norm': True, 'ema': False, 'ema_rate': 0.9999, 'toy': False, 'class_cond': True, 'clip_denoised': True, 'num_samples': 20, 'diffusion_batch_size': 64, 'use_ddim': False, 'model_path': '', 'classifier_path': '', 'schedule_sampler': 'uniform', 'diffusion_lr': 0.0001, 'diffusion_weight_decay': 0.0, 'diffusion_lr_warmup_steps': 500, 'lr_anneal_steps': 15000, 'diffusion_steps': 1000, 'num_inference_timesteps': 100, 'log_interval': 10, 'save_interval': 500, 'resume_checkpoint': '', 'use_fp16': True, 'fp16_scale_growth': 0.001, 'num_classes': 100, 'tr_results_root_path': '/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train', 'models_root_path': '/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/models', 'test_results_root_path': '/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/test', 'nr_class': 100, 'nr_class_remain': 50, 'nr_class_per_task': 5, 'data_dir': None, 'init_model_path': None, 'inv_drop_margin': 0.5, 'first_task_modelname': 'e=100_bs=256_lr=[1e-05, 0.0001, 0.001, 0.005, 0.01, 0.05]_L2=0.0005', 'train_first_task': True, 'wrap_first_task_model': False, 'no_framework': False, 'first_task_basemodel_dump': False, 'timing_mode': False, 'debug': False}
Manager={'dataset': <src.data.dataset.Cifar100ClassIncrementalDataset object at 0x7f46ed2add20>, 'method': <src.methods.method.CPDM object at 0x7f46ed2adc60>, 'previous_task_model_path': '/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/models/alexnetCI_pretrained_imgnet.pth.tar', 'parent_exp_dir': '/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self', 'base_model': <src.models.net.AlexNetCI object at 0x7f46ed2adcf0>, 'current_task_dataset_path': None, 'best_finetuned_model_path': None, 'autoencoder_model_path': None}

 ******************************************************************************** 
 TRAINING Task 1 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  1
classifier_heads_starting_idx =  6

PHASE 1 (TASK 1)

PHASE 2 (TASK 1)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_1/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 6.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 6.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=6.0 (backup=6.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_1/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 2 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  2
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/1/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 2)

PHASE 2 (TASK 2)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_2/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 12.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 12.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=12.0 (backup=12.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_2/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 3 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  3
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/2/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 3)

PHASE 2 (TASK 3)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_3/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 24.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 24.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=24.0 (backup=24.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_3/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 4 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  4
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/3/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 4)

PHASE 2 (TASK 4)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_4/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 48.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 48.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=48.0 (backup=48.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_4/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 5 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  5
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/4/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 5)

PHASE 2 (TASK 5)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_5/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 96.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 96.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=96.0 (backup=96.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_5/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 6 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  6
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/5/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 6)

PHASE 2 (TASK 6)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_6/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 192.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 192.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=192.0 (backup=192.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_6/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 7 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  7
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/6/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 7)

PHASE 2 (TASK 7)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_7/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 384.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 384.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=384.0 (backup=384.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_7/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 8 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  8
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/7/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 8)

PHASE 2 (TASK 8)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_8/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 768.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 768.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=768.0 (backup=768.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_8/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 9 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  9
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/8/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 9)

PHASE 2 (TASK 9)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_9/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 1536.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 1536.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=1536.0 (backup=1536.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_9/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 10 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  10
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/9/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 10)

PHASE 2 (TASK 10)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_10/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 3072.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 3072.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=3072.0 (backup=3072.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_10/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0

 ******************************************************************************** 
 TRAINING Task 11 
 ********************************************************************************
HEURISTIC BASED METHOD: Task  11
reg_sets= ['/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/10/imgfolder_trainvaltest.pth.tar']
classifier_heads_starting_idx =  6

PHASE 1 (TASK 11)

PHASE 2 (TASK 11)
********************  FT LR  0.001 ********************
Initiating framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_11/TASK_TRAINING/hyperparams.pth.tar
Restoring to state = {'hyperparams': OrderedDict([('ulhyper', 6144.0)]), 'hyperparams_backup': OrderedDict([('ulhyper', 6144.0)]), 'hyperparam_idx': 0, 'attempts': 0}
---------------------------------------- 
 Restored Framework
hyperparam ulhyper=6144.0 (backup=6144.0)
hyperparam_idx=0
attempts=0
----------------------------------------
SUCCESSFUL loading framework chkpt:/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_11/TASK_TRAINING/hyperparams.pth.tar
phase1_elapsed_time=0, presteps_elapsed_time=0, convergence_iteration_elapsed_time=0, postprocess_time=0
CUDA MAX MEM ALLOC >>> 0 <<<
CUDA MAX MEM CACHE >>> 0 <<<

TESTING ON DATASETS:
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/1/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/2/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/3/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/4/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/5/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/6/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/7/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/8/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/9/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/10/imgfolder_trainvaltest.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/data/datasets/cifarCI/cifar100CI/no_crop/cifar100CI_init_task+10tasks_rndseed=None/11/imgfolder_trainvaltest.pth.tar

TESTING ON MODELS:
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_1/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_2/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_3/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_4/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_5/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_6/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_7/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_8/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_9/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_10/TASK_TRAINING/best_model.pth.tar
/fs03/ml20/ilee0022/CPDM/py-CPDM1.1/src/results/train/cifar100CI_init_task+10tasks_rndseed=None/CPDM/alexnetCI_pretrained_imgnet/gridsearch/demo/dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self/task_11/TASK_TRAINING/best_model.pth.tar
Testing on  11  task datasets
Testing_model: 0	Accuracy: 58.12000000	forgetting: 0.00000000

Testing_model: 1	Accuracy: 66.66000000	forgetting: 6.40000000

Testing_model: 2	Accuracy: 69.80666667	forgetting: 7.43333333

Testing_model: 3	Accuracy: 70.96500000	forgetting: 8.86500000

Testing_model: 4	Accuracy: 70.93600000	forgetting: 9.48800000

Testing_model: 5	Accuracy: 68.76666667	forgetting: 12.62000000

Testing_model: 6	Accuracy: 69.85714286	forgetting: 12.01714286

Testing_model: 7	Accuracy: 70.85500000	forgetting: 12.21000000

Testing_model: 8	Accuracy: 69.43111111	forgetting: 13.91555556

Testing_model: 9	Accuracy: 68.35600000	forgetting: 15.55600000

Testing_model: 10	Accuracy: 68.67818182	forgetting: 15.89636364

TOTAL EVAL TIMING >>> 200.13652777671814 <<<
CUDA MAX MEM ALLOC >>> 335220224 <<<
CUDA MAX MEM CACHE >>> 346030080 <<<
FINISHED testing of:  dm=0.5_df=0.5_e=100_bs=256_diffusion_steps=1000_num_samples=20_ddim=100_nearest_label=cosine_tau=0.0001_image_condition=learn_image_condition_learn_lr=0.01_image_condition_learn_L2=0.01_max_grad_norm_L2=0.0005_ulhyper=3.0_classifier_type=self
